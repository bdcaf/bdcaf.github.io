<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Configuring Syncthing on Mac Server - bdcaf</title><meta name=theme-color><meta name=description content="Syncthing is currently my preferred tool to
keep folders in sync.  Previously I had affairs with git
annex, and
rsync scripts.
Recently I reactivated a 2009 Mac Mini as headless server under El
Capitan.  Homebrew is the tool of choice - it
complains a little about the old OS but things work out nicely."><meta name=author content="bdcaf"><link rel="preload stylesheet" as=style href=https://bdcaf.github.io/main.min.e86ae67e01e2d2055106abf72be7357c950191060e5f159f24e2790fd8237e8c.css integrity="sha256-6GrmfgHi0gVRBqv3K+c1fJUBkQYOXxWfJOJ5D9gjfow="><link rel=preload as=image href=https://bdcaf.github.io/theme.png><link rel=preload as=image href=https://bdcaf.github.io/github.svg><link rel=preload as=image href=https://bdcaf.github.io/linkedin.svg><link rel=preload as=image href=https://bdcaf.github.io/rss.svg><script defer src=https://bdcaf.github.io/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://bdcaf.github.io/favicon.ico><link rel=apple-touch-icon href=https://bdcaf.github.io/apple-touch-icon.png><meta name=generator content="Hugo 0.155.2"><meta itemprop=name content="Configuring Syncthing on Mac Server"><meta itemprop=description content="Syncthing is currently my preferred tool to keep folders in sync. Previously I had affairs with git annex, and rsync scripts.
Recently I reactivated a 2009 Mac Mini as headless server under El Capitan. Homebrew is the tool of choice - it complains a little about the old OS but things work out nicely."><meta itemprop=datePublished content="2019-02-05T10:58:41+01:00"><meta itemprop=dateModified content="2021-02-21T09:43:37+01:00"><meta itemprop=wordCount content="542"><meta itemprop=keywords content="Syncthing,Mac"><meta property="og:url" content="https://bdcaf.github.io/post/mac/syncthing/"><meta property="og:site_name" content="bdcaf"><meta property="og:title" content="Configuring Syncthing on Mac Server"><meta property="og:description" content="Syncthing is currently my preferred tool to keep folders in sync. Previously I had affairs with git annex, and rsync scripts.
Recently I reactivated a 2009 Mac Mini as headless server under El Capitan. Homebrew is the tool of choice - it complains a little about the old OS but things work out nicely."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-02-05T10:58:41+01:00"><meta property="article:modified_time" content="2021-02-21T09:43:37+01:00"><meta property="article:tag" content="Syncthing"><meta property="article:tag" content="Mac"><meta name=twitter:card content="summary"><meta name=twitter:title content="Configuring Syncthing on Mac Server"><meta name=twitter:description content="Syncthing is currently my preferred tool to keep folders in sync. Previously I had affairs with git annex, and rsync scripts.
Recently I reactivated a 2009 Mac Mini as headless server under El Capitan. Homebrew is the tool of choice - it complains a little about the old OS but things work out nicely."><link rel=canonical href=https://bdcaf.github.io/post/mac/syncthing/></head><body class="bg-(--bg) text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"><div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto"><a class="-translate-y-[1px] text-2xl font-medium" href=https://bdcaf.github.io/>bdcaf</a><div class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"rgb(0 0 0 / 85%)":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/>Blog</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/publication/>Publications</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/about/>About</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/contact/>Contact</a></nav><nav class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"><a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/bdcaf target=_blank rel=me>github</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./linkedin.svg) href=https://linkedin.com/in/clemens-a-1228a295 target=_blank rel=me>linkedin</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://bdcaf.github.io/index.xml target=_blank rel=alternate>rss</a></nav></div></header><main class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"><article><header class=mb-14><h1 class="my-0! pb-2.5">Configuring Syncthing on Mac Server</h1><div class="text-xs antialiased opacity-60"><time>Feb 5, 2019</time></div></header><section><p><a href=https://syncthing.net>Syncthing</a> is currently my preferred tool to
keep folders in sync. Previously I had affairs with <a href=https://git-annex.branchable.com>git
annex</a>, and
<a href=https://rsync.samba.org>rsync</a> scripts.</p><p>Recently I reactivated a 2009 Mac Mini as headless server under El
Capitan. <a href=https://brew.sh>Homebrew</a> is the tool of choice - it
complains a little about the old OS but things work out nicely.</p><h2 id=hard-drives-not-being-mounted>hard drives not being mounted</h2><p>However the first issue was that the drives would not be mounted
without a user logging in. I was able to find following
<a href=https://gist.github.com/jabenninghoff/f13f81c286e914c48942f973f5d15819>snippet</a>:</p><pre><code>sudo defaults write /Library/Preferences/SystemConfiguration/autodiskmount AutomountDisksWithoutUserLogin -bool true
</code></pre><h2 id=syncthing-not-starting>syncthing not starting</h2><p>Homebrew documents how the get syncthing started for a user. However
again this would mean someone would need to login before things get
going. I was able to resolve this by moving the installed plist from
<code>~/Library/LaunchAgents/</code> to <code>/Library/LaunchDaemons/</code> and adding the
entry:</p><pre><code>  &lt;key&gt;UserName&lt;/key&gt;
  &lt;string&gt;myuser&lt;/string&gt;
</code></pre><p>So it would finally launch.</p><h2 id=syncthing-launching-before-harddrive>syncthing launching before harddrive</h2><p>However it turned out it would launch syncthing <em>before</em> the external
drive was ready so syncthing would spew errors and not sync without
interaction.</p><p>I was not able to solve this within the plist so I created a quick
shellscript that would sleep until the drive was ready:</p><pre><code>#!/bin/sh
SYNCDRIVE='/Volumes/Media/'
while [ ! -d &quot;$SYNCDRIVE&quot; ]; do
sleep 10
done
/usr/local/opt/syncthing/bin/syncthing -no-browser -no-restart
</code></pre><h2 id=firewall>firewall</h2><p>After all this it was still not syncing. Being on a headless machine
I haven&rsquo;t gotten the firewall warning. So the final step was easy to
allow <code>syncthing</code> getting connections.</p><h2 id=ssh>ssh</h2><p>Last thing was getting things to work was to get to sync through an
ssh tunnel. There is a <a href=https://docs.syncthing.net/users/tunneling.html>good
description</a> however
I made the mistake to skim the last port number. Turns out in the
last command they leave one digit away so search all the ports. Once
fixing to <code>22000</code> all syncing starts/</p><h3 id=on-my-current-decisions>on my current decisions</h3><p>With annex I continuously had problems that my repos wouldn&rsquo;t merge
nicely. Also although it is under active development the
documentation is difficult to read - many examples on the site are 5
years or older, which makes it difficult to realise which apply to the
current version. I just never managed to get it sync automatically.
Rsync always had to be run to check for changes. Since it has to
rescan the remote files it always takes some extra toll. This is
great for some tasks. But for my application where I control all
endpoints it was unnecessary.</p><p>My machine wouldn&rsquo;t run the latest Mac OS so I had to choose El Capitan.
Instead of Mac OS I also experimented with Ubuntu linux.
Linux would offer me all the latest versions and installed nicely.
Unfortunately I quickly ran into troubles - updating was not as smooth
as I am used to. Every other time I had to tweak GRUB as the machine
would not boot. Also I noticed I was not able to use all of the
hardware. The most problematic was power management as I didn&rsquo;t want
the machine to burn its cupboard. But I also was unable to get the
graphics card and more than one CPU core working. Searching the
internet led me to believe this is a common trouble. But maybe in a
few years when El Capitan no longer gets security patches I will
change.</p></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://bdcaf.github.io/tags/syncthing>syncthing</a><a class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://bdcaf.github.io/tags/mac>mac</a></footer><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg leading-[1.2]! *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://bdcaf.github.io/post/site/2019_layout/><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>Grid Layout for Site</span></a><a class="justify-end pl-3 ltr:ml-auto rtl:mr-auto" href=https://bdcaf.github.io/post/links/colliding_blocks/><span>Colliding Blocks</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav></article></main><footer class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"><div class=mr-auto>&copy;2026
<a class=link href=https://bdcaf.github.io/>bdcaf</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a></footer></body></html>