<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Mass spectra visualization - bdcaf</title><meta name=theme-color><meta name=description content="I saw some nice visualiztion for IP
adresses
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well.  Unfortunately the
opposite does not hold.  Conveniently a function to produce a hilbert
curve is provided via
HilbertVis
on bioconductor."><meta name=author content="bdcaf"><link rel="preload stylesheet" as=style href=https://bdcaf.github.io/main.min.e86ae67e01e2d2055106abf72be7357c950191060e5f159f24e2790fd8237e8c.css integrity="sha256-6GrmfgHi0gVRBqv3K+c1fJUBkQYOXxWfJOJ5D9gjfow="><link rel=preload as=image href=https://bdcaf.github.io/theme.png><link rel=preload as=image href=https://bdcaf.github.io/github.svg><link rel=preload as=image href=https://bdcaf.github.io/linkedin.svg><link rel=preload as=image href=https://bdcaf.github.io/rss.svg><script defer src=https://bdcaf.github.io/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://bdcaf.github.io/favicon.ico><link rel=apple-touch-icon href=https://bdcaf.github.io/apple-touch-icon.png><meta name=generator content="Hugo 0.155.2"><meta itemprop=name content="Mass spectra visualization"><meta itemprop=description content="I saw some nice visualiztion for IP adresses which made use of the hilbert curve for mapping sequatial data into an area. This has the nice benefit of assuring numbers that are close to each other stay close in two dimensions as well. Unfortunately the opposite does not hold. Conveniently a function to produce a hilbert curve is provided via HilbertVis on bioconductor."><meta itemprop=datePublished content="2016-03-30T00:00:00+00:00"><meta itemprop=dateModified content="2021-02-21T09:43:37+01:00"><meta itemprop=wordCount content="518"><meta itemprop=keywords content="Science,Visualisation"><meta property="og:url" content="https://bdcaf.github.io/post/2016/2016-01-hilbertptr/"><meta property="og:site_name" content="bdcaf"><meta property="og:title" content="Mass spectra visualization"><meta property="og:description" content="I saw some nice visualiztion for IP adresses which made use of the hilbert curve for mapping sequatial data into an area. This has the nice benefit of assuring numbers that are close to each other stay close in two dimensions as well. Unfortunately the opposite does not hold. Conveniently a function to produce a hilbert curve is provided via HilbertVis on bioconductor."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2016-03-30T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-21T09:43:37+01:00"><meta property="article:tag" content="Science"><meta property="article:tag" content="Visualisation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mass spectra visualization"><meta name=twitter:description content="I saw some nice visualiztion for IP adresses which made use of the hilbert curve for mapping sequatial data into an area. This has the nice benefit of assuring numbers that are close to each other stay close in two dimensions as well. Unfortunately the opposite does not hold. Conveniently a function to produce a hilbert curve is provided via HilbertVis on bioconductor."><link rel=canonical href=https://bdcaf.github.io/post/2016/2016-01-hilbertptr/></head><body class="bg-(--bg) text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"><div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto"><a class="-translate-y-[1px] text-2xl font-medium" href=https://bdcaf.github.io/>bdcaf</a><div class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"rgb(0 0 0 / 85%)":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/>Blog</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/publication/>Publications</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/about/>About</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/contact/>Contact</a></nav><nav class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"><a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/bdcaf target=_blank rel=me>github</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./linkedin.svg) href=https://linkedin.com/in/clemens-a-1228a295 target=_blank rel=me>linkedin</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://bdcaf.github.io/index.xml target=_blank rel=alternate>rss</a></nav></div></header><main class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"><article><header class=mb-14><h1 class="my-0! pb-2.5">Mass spectra visualization</h1><div class="text-xs antialiased opacity-60"><time>Mar 30, 2016</time></div></header><section><p>I saw some <a href=http://datadrivensecurity.info/blog/posts/2015/Jan/mapping-ipv4-address-in-hilbert-space/>nice visualiztion for IP
adresses</a>
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well. Unfortunately the
opposite does not hold. Conveniently a function to produce a hilbert
curve is provided via
<a href=https://bioconductor.org/packages/release/bioc/html/HilbertVis.html>HilbertVis</a>
on bioconductor.</p><h3 id=ptr-ms-spectra>PTR-MS spectra</h3><p>I have been playing with PTR-MS data for some while. It&rsquo;s always hard to
visualize this datasets. There are some nice patterns showing up - isotopic and
due to hydratization.</p><h3 id=data>data</h3><p>I will not show out reading out the data - it was collected using a Ionicon PTR-TOF MS
which requires tedious preprocessing - most of which I can finally do in R but
the code is poorly documented so far. The measurment is actually from a proband
who took a sip of ethanol a few minutes before measurement.</p><p>Just a glimpse of it looks like this:</p><table><thead><tr><th>mass</th><th>counts</th></tr></thead><tbody><tr><td>21</td><td>142720</td></tr><tr><td>22</td><td>18708</td></tr><tr><td>23</td><td>8148</td></tr><tr><td>24</td><td>7137</td></tr><tr><td>25</td><td>6711</td></tr><tr><td>26</td><td>6468</td></tr></tbody></table><h2 id=experiments>Experiments</h2><p>Since over m/z 100 there is only sparse signal I created the relevant Hilbert
curve doing</p><h3 id=curves>Curves</h3><p>The first plot uses scales the area of the dots at the masses to the observed counts.</p><p><img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_firsttry-1.png alt="plot of chunk first try"></p><p>This plot shows a little structure - the main blocks are of 16 numbers.</p><ul><li>The numbers 1 to 16 are basically zero as there are no protonated ions at such masses.</li><li>The next block contains the major precursors - the hydronium ion
\(H_3O^+\) with its isotopes at m/z 19 to 21, \(NO^+\) at 30 and
\(O_2^+\) at 32. A little visible is ammonia at m/z 18.</li><li>The block from 33 to 48 contains the Zundel ion (\(H_2O \cdot
H_3O^+\) ) as well as ethanol at 47 (with some isotops at 48) and its
metabolite acetaldehyde at 45.</li><li>Following block contains the important compound acetone at 59 and
not visible the next metabolite of ethanol acetic acid at 61.</li><li>Next block contains isoprene at 69 as well as hydrated ethanol ion at 65.</li><li>The following blocks show no visible ions although at aromatics like toluene (m/z 93) should show up there.</li></ul><p>Unfortunately when observed on the PTR-TOF it can be seen that the signal is
saturated at m/z 19, 37 and 47. So lets scale down the max signal.<br>The concentration of the observed compounds is in the ppm&rsquo;s.
<img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_scaledin-1.png alt="plot of chunk scaled in"></p><p>Finally we see a little more. But still only compounds that occur in<br>concentrations of several ppbs.</p><p>Lets try to use logarithmic scale instead.</p><p><img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_logscale-1.png alt="plot of chunk log scale"></p><p>Now the plot shows many more compounds. All the main ions are tailed by some ions of their isotopes. Though it is still hard to see where some traces occur. I experimentd with some zooming but overall there was little benefit to it. My next try will be to see if I can create an animated version of this to follow a volunteers breath pattern.</p><p>The code for this page was written in <code>R</code>. I will keep investigating and probably put a link to the git repo online once it reaches a more mature state.</p></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://bdcaf.github.io/tags/science>science</a><a class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://bdcaf.github.io/tags/visualisation>visualisation</a></footer><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg leading-[1.2]! *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://bdcaf.github.io/post/kalman_tot/><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>R.E. Kalman verstorben</span></a><a class="justify-end pl-3 ltr:ml-auto rtl:mr-auto" href=https://bdcaf.github.io/post/2015/2015-11-15_zero/><span>Zero Axis Video</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav></article></main><footer class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"><div class=mr-auto>&copy;2026
<a class=link href=https://bdcaf.github.io/>bdcaf</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a></footer></body></html>