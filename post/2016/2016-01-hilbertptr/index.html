<!doctype html><html class=no-js lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>Mass spectra visualization - bdcaf</title>
<script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script>
<meta name=description content>
<meta property="og:title" content="Mass spectra visualization">
<meta property="og:description" content="I saw some nice visualiztion for IP
adresses
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well.  Unfortunately the
opposite does not hold.  Conveniently a function to produce a hilbert
curve is provided via
HilbertVis
on bioconductor.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://bdcaf.github.io/post/2016/2016-01-hilbertptr/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2016-03-30T00:00:00+00:00">
<meta property="article:modified_time" content="2021-02-21T09:43:37+01:00">
<meta itemprop=name content="Mass spectra visualization">
<meta itemprop=description content="I saw some nice visualiztion for IP
adresses
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well.  Unfortunately the
opposite does not hold.  Conveniently a function to produce a hilbert
curve is provided via
HilbertVis
on bioconductor."><meta itemprop=datePublished content="2016-03-30T00:00:00+00:00">
<meta itemprop=dateModified content="2021-02-21T09:43:37+01:00">
<meta itemprop=wordCount content="518">
<meta itemprop=keywords content="science,visualisation,">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Mass spectra visualization">
<meta name=twitter:description content="I saw some nice visualiztion for IP
adresses
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well.  Unfortunately the
opposite does not hold.  Conveniently a function to produce a hilbert
curve is provided via
HilbertVis
on bioconductor.">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=dns-prefetch href=//fonts.gstatic.com>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
<link rel=stylesheet href=https://bdcaf.github.io/bundle.min.b875f52a21dac7468ad41e3eb2cf61550b91e4e52debedf1ea5891129de74ac7.css integrity="sha256-uHX1KiHax0aK1B4+ss9hVQuR5OUt6+3x6liREp3nSsc=">
<link rel="shortcut icon" href=/favicon.ico>
</head>
<body class=body>
<div class="container container--outer">
<header class=header>
<div class="container header__container">
<div class="logo logo--mixed">
<a class=logo__link href=/ title=bdcaf rel=home>
<div class="logo__item logo__imagebox">
<img class=logo__img src=/img/Logo_c.svg>
</div><div class="logo__item logo__text">
<div class=logo__title>bdcaf</div>
<div class=logo__tagline>Clemens' blog</div>
</div>
</a>
</div>
<nav class=menu>
<button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span>
</button>
<ul class=menu__list>
<li class=menu__item>
<a class=menu__link href=/>
<span class=menu__text>Blog</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/publication/>
<span class=menu__text>Publications</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/page/about/>
<span class=menu__text>About</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/page/contact/>
<span class=menu__text>Contact</span>
</a>
</li>
</ul>
</nav>
</div>
</header>
<div class="wrapper flex">
<div class=primary>
<main class=main role=main>
<article class=post>
<header class=post__header>
<h1 class=post__title>Mass spectra visualization</h1><div class="post__meta meta">
<div class="meta__item-datetime meta__item">
<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-03-30T00:00:00Z>Wed, Mar 30, 2016</time>
<time class=meta__text datetime=2021-02-21T09:43:37+01:00>(Last Modified: Sun, Feb 21, 2021)</time></div></div>
</header><div class="content post__content clearfix">
<p>I saw some <a href=http://datadrivensecurity.info/blog/posts/2015/Jan/mapping-ipv4-address-in-hilbert-space/>nice visualiztion for IP
adresses</a>
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well. Unfortunately the
opposite does not hold. Conveniently a function to produce a hilbert
curve is provided via
<a href=https://bioconductor.org/packages/release/bioc/html/HilbertVis.html>HilbertVis</a>
on bioconductor.</p>
<h3 id=ptr-ms-spectra>PTR-MS spectra</h3>
<p>I have been playing with PTR-MS data for some while. It&rsquo;s always hard to
visualize this datasets. There are some nice patterns showing up - isotopic and
due to hydratization.</p>
<h3 id=data>data</h3>
<p>I will not show out reading out the data - it was collected using a Ionicon PTR-TOF MS
which requires tedious preprocessing - most of which I can finally do in R but
the code is poorly documented so far. The measurment is actually from a proband
who took a sip of ethanol a few minutes before measurement.</p>
<p>Just a glimpse of it looks like this:</p>
<table>
<thead>
<tr>
<th>mass</th>
<th>counts</th>
</tr>
</thead>
<tbody>
<tr>
<td>21</td>
<td>142720</td>
</tr>
<tr>
<td>22</td>
<td>18708</td>
</tr>
<tr>
<td>23</td>
<td>8148</td>
</tr>
<tr>
<td>24</td>
<td>7137</td>
</tr>
<tr>
<td>25</td>
<td>6711</td>
</tr>
<tr>
<td>26</td>
<td>6468</td>
</tr>
</tbody>
</table>
<h2 id=experiments>Experiments</h2>
<p>Since over m/z 100 there is only sparse signal I created the relevant Hilbert
curve doing</p>
<h3 id=curves>Curves</h3>
<p>The first plot uses scales the area of the dots at the masses to the observed counts.</p>
<p><img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_firsttry-1.png alt="plot of chunk first try"></p>
<p>This plot shows a little structure - the main blocks are of 16 numbers.</p>
<ul>
<li>The numbers 1 to 16 are basically zero as there are no protonated ions at such masses.</li>
<li>The next block contains the major precursors - the hydronium ion
\(H_3O^+\) with its isotopes at m/z 19 to 21, \(NO^+\) at 30 and
\(O_2^+\) at 32. A little visible is ammonia at m/z 18.</li>
<li>The block from 33 to 48 contains the Zundel ion (\(H_2O \cdot
H_3O^+\) ) as well as ethanol at 47 (with some isotops at 48) and its
metabolite acetaldehyde at 45.</li>
<li>Following block contains the important compound acetone at 59 and
not visible the next metabolite of ethanol acetic acid at 61.</li>
<li>Next block contains isoprene at 69 as well as hydrated ethanol ion at 65.</li>
<li>The following blocks show no visible ions although at aromatics like toluene (m/z 93) should show up there.</li>
</ul>
<p>Unfortunately when observed on the PTR-TOF it can be seen that the signal is
saturated at m/z 19, 37 and 47. So lets scale down the max signal.<br>
The concentration of the observed compounds is in the ppm&rsquo;s.
<img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_scaledin-1.png alt="plot of chunk scaled in"></p>
<p>Finally we see a little more. But still only compounds that occur in<br>
concentrations of several ppbs.</p>
<p>Lets try to use logarithmic scale instead.</p>
<p><img src=/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_logscale-1.png alt="plot of chunk log scale"></p>
<p>Now the plot shows many more compounds. All the main ions are tailed by some ions of their isotopes. Though it is still hard to see where some traces occur. I experimentd with some zooming but overall there was little benefit to it. My next try will be to see if I can create an animated version of this to follow a volunteers breath pattern.</p>
<p>The code for this page was written in <code>R</code>. I will keep investigating and probably put a link to the git repo online once it reaches a more mature state.</p>
</div>
<footer class=post__footer>
<div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg>
<ul class=tags__list>
<li class=tags__item>
<a class="tags__link btn" href=/tags/science/ rel=tag>science</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/visualisation/ rel=tag>visualisation</a>
</li>
</ul>
</div>
</footer>
</article>
</main>
</div>
</div>
<footer class=footer>
<div class="container footer__container flex">
<div class=footer__links>
<a class=footer__link href=/page/about/>About</a> | <a class=footer__link href=/page/contact/>Contact</a>
</div>
<div class=footer__copyright>
&copy; 2021 Clemens Ager.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span>
</div>
</div>
</footer>
</div>
<script async defer src=/js/menu.js></script>
</body>
</html>